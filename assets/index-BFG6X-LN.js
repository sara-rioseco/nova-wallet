(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function l(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(a){if(a.ep)return;a.ep=!0;const r=l(a);fetch(a.href,r)}})();const W=s=>{const o=document.createElement("button");return o.id=`button-${s.replace(" ","")}`,o.classList.add=`${s.replace(" ","")}-button`,o.textContent=`${s.charAt(0).toUpperCase()+s.slice(1)}`,o},S=(s,o,l)=>{const i=document.createElement("div"),a=document.createElement("input"),r=document.createElement("label");return i.classList.add("input-wrapper"),a.classList.add("input","input-text"),r.classList.add("label","input-label"),a.type=l||"search",a.id=`${o}`,a.autocomplete="new-password",a.placeholder=" ",a.name=`${s}`,a.required=!0,l==="number"&&(a.step="0.01",a.min="0.01",a.max="10000.01"),r.setAttribute("for",`${o}`),r.textContent=`Enter your ${s}`,i.appendChild(a),i.appendChild(r),i};function I(){const s="https://json-server-gamma-brown.vercel.app/users",o=async function(){try{return await(await fetch(s,{credentials:"include"})).json()}catch(e){throw new Error(e)}},l=e=>e.users,i=(e,t)=>{if(!e||!t||typeof t!="number")throw new Error("Wrong argument types");const c=e.users.find(n=>n.id===t);if(!c)throw new Error("Unable to find user");return c},a=(e,t)=>{if(!e||!t||typeof t!="string")throw new Error("Wrong argument types");const c=e.users.find(n=>n.email===t);if(!c)throw new Error("Unable to find user");return c},r=async function(e,t,c,n,u){if(!e||!t||!c||!n||!u)throw new Error("Missing arguments");if(typeof t!="string"||typeof c!="string"||typeof n!="string"||typeof u!="string")throw new Error("Wrong argument types");const w={id:e.users.length+1,name:t,lastname:c,email:n,password:u,role:"user",balance:0,transactions:[],contacts:[]};e.users.push(w);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),w}catch(L){throw new Error(L)}},m=async function(e,t,c){if(!e||!t||typeof t!="number")throw new Error("Id of type number is required");const n=i(e,t),u={id:t,name:c.name||n.name,lastname:c.lastname||n.lastname,email:n.email,password:c.password||n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:n.contacts},b=e.users.indexOf(n);e.users.splice(b,1,u);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),u}catch(w){throw new Error(w)}},y=async(e,t,c)=>{if(!e||!t||!c||typeof t!="string"||typeof c!="string")throw new Error("Wrong argument types");const n=await a(e,t);if(n&&n.password===c)return n;throw new Error("Wrong credentials")},f=e=>e.balance,d=async(e,t,c)=>{if(!e||!t||!c||typeof t!="number"||typeof c.amount!="number")throw new Error("Wrong argument types");const n=i(e,t),u=n.balance+c.amount,b={id:t,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:u,transactions:n.transactions,contacts:n.contacts},w=e.users.indexOf(n);e.users.splice(w,1,b);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),b.balance}catch(L){throw new Error(L)}},g=e=>!e||!e.transactions?[]:e.transactions,h=async(e,t,c)=>{if(!e||!t||!c||typeof t!="number"||typeof c!="number")throw new Error("Wrong argument types");const n=i(e,t),u=g(n),b={date:new Date().toLocaleDateString(),amount:c,type:c>0?"deposit":"transfer"};u.push(b);const w={id:t,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:u,contacts:n.contacts},L=e.users.indexOf(n);e.users.splice(L,1,w);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),w.transactions[u.length-1]}catch(D){throw new Error(D)}},p=e=>!e||!e.contacts?[]:e.contacts,E=(e,t,c)=>{if(!e||!t||!c||typeof t!="number"||typeof c!="number")throw new Error("Wrong argument types");const n=i(e,t),u=e.users.indexOf(n),b=e.users[u].contacts.find(w=>w.id===c);if(b)return b;throw new Error("Unable to find contact")};return{dataUrl:s,getData:o,getUsers:l,getUserById:i,getUserByEmail:a,createUser:r,updateUser:m,userLogin:y,getBalance:f,updateBalance:d,getTransactions:g,addTransaction:h,getContacts:p,getContactById:E,addContact:async(e,t,c)=>{if(!e||!t||!c||typeof t!="number")throw new Error("Wrong argument types");const n=i(e,t),u=p(n),b={id:u.length+1,name:c.name,lastname:c.lastname,email:c.email};u.push(b);const w={id:t,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:u},L=e.users.indexOf(n);e.users.splice(L,1,w);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),w.contacts[u.length-1]}catch(D){throw new Error(D)}},updateContact:async(e,t,c,n)=>{if(!e||!t||!c||!n||typeof t!="number"||typeof c!="number")throw new Error("Wrong argument types");const u=i(e,t),b=p(u),w=E(e,t,c),L=b.indexOf(w),D={id:c,name:n.name||w.name,lastname:n.lastname||w.lastname,email:n.email||w.email};b.splice(L,1,D);const B={id:t,name:u.name,lastname:u.lastname,email:u.email,password:u.password,role:u.role,balance:u.balance,transactions:u.transactions,contacts:b},q=e.users.indexOf(u);e.users.splice(q,1,B);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),B.contacts[L]}catch(M){throw new Error(M)}},deleteContact:async(e,t,c)=>{if(!e||!t||!c||typeof t!="number"||typeof c!="number")throw new Error("Wrong argument types");const n=i(e,t),u=p(n),b=E(e,t,c),w=u.indexOf(b);u.splice(w,1);const L={id:t,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:u},D=e.users.indexOf(n);e.users.splice(D,1,L);try{return await(void 0)(s,JSON.stringify(e),{encoding:"utf-8"}),L.contacts}catch(B){throw new Error(B)}}}}const{getData:H,userLogin:V}=I();function j(s){const o=document.createElement("div"),l=document.createElement("form"),i=document.createElement("h1"),a=document.createElement("span"),r=S("username","login-username","text"),m=S("Email","login-email"),y=S("Password","login-password","password"),f=W("login"),d=document.createElement("p"),g=document.createElement("span");return o.className="login-wrapper",l.className="login-content-wrapper",i.textContent="Nova",a.textContent="Wallet",r.autocomplete="username",r.hidden=!0,r.classList.add("visually-hidden"),d.classList.add("login-text"),d.textContent=`Don't have an account?
`,g.textContent="Sign up here.",$(f).click(async h=>{h.preventDefault();const p=$("#login-email").val(),E=$("#login-password").val();try{const v=await H(),C=await V(v,p,E);localStorage.setItem("uid",C.id),localStorage.setItem("name",C.name),localStorage.setItem("lastname",C.lastname),localStorage.setItem("email",C.email),localStorage.setItem("role",C.role),s("/nova-wallet/home")}catch(v){alert("Invalid credentials"),console.error(v)}}),$(g).click(()=>{s("/nova-wallet/signup")}),$(i).append(a),$(d).append(g),$(l).append(i,r,m,y,f,d),$(o).append(l),o}const{getData:z,createUser:R}=I();function Z(s){const o=document.createElement("div"),l=document.createElement("form"),i=document.createElement("h1"),a=document.createElement("span"),r=S("username","signup-username","text"),m=S("Name","signup-name","text"),y=S("Lastname","signup-lastname","text"),f=S("Email","signup-email"),d=S("Password","signup-password","password"),g=W("sign up"),h=document.createElement("p"),p=document.createElement("span");return o.className="signup-wrapper",l.className="signup-content-wrapper",i.textContent="Nova",a.textContent="Wallet",r.autocomplete="username",r.hidden=!0,r.classList.add("visually-hidden"),h.classList.add("signup-text"),h.textContent=`Already have an account?
`,p.textContent="Login here.",$(g).click(async E=>{E.preventDefault();const v=$("#signup-name").val(),C=$("#signup-lastname").val(),x=$("#signup-email").val(),e=$("#signup-password").val();console.log("trying to sign up user: ",v,C,x);try{const t=await z(),c=await R(t,v,C,x,e);localStorage.setItem("uid",c.id),localStorage.setItem("name",c.name),localStorage.setItem("lastname",c.lastname),localStorage.setItem("email",c.email),localStorage.setItem("role",c.role),alert("User created successfully"),s("/nova-wallet/home")}catch(t){alert("Unable to create user"),console.error(t.message)}s("/nova-wallet/home")}),$(p).click(()=>{s("/nova-wallet/")}),$(i).append(a),$(h).append(p),$(l).append(i,r,m,y,f,d,g,h),$(o).append(l),o}const N=s=>{const o=document.createElement("header"),l=document.createElement("div"),i=document.createElement("h1"),a=document.createElement("span"),r=document.createElement("nav"),m=document.createElement("button"),y=document.createElement("span"),f=document.createElement("div"),d=document.createElement("ul"),g=document.createElement("li"),h=document.createElement("li"),p=document.createElement("li"),E=document.createElement("li"),v=document.createElement("li");l.classList.add("header-container"),i.classList.add("logo"),r.classList.add("site-nav"),m.classList.add("menu-toggle"),i.textContent="Nova",a.textContent="Wallet",m.setAttribute("aria-controls","primary-navigation"),m.setAttribute("aria-expanded","false"),y.classList.add("visually-hidden"),f.classList.add("hamburger"),f.setAttribute("aria-hidden","true"),i.appendChild(a),m.appendChild(y),m.appendChild(f),d.classList.add("primary-navigation"),d.id="primary-navigation",d.setAttribute("data-state","closed"),g.textContent="Home",h.textContent="Deposit",p.textContent="Send Money",E.textContent="Transactions",v.textContent="Logout",i.addEventListener("click",()=>s("/nova-wallet/home")),g.addEventListener("click",()=>s("/nova-wallet/home")),h.addEventListener("click",()=>s("/nova-wallet/deposit")),p.addEventListener("click",()=>s("/nova-wallet/transfer")),E.addEventListener("click",()=>s("/nova-wallet/transactions")),v.addEventListener("click",()=>{localStorage.removeItem("name"),localStorage.removeItem("lastname"),localStorage.removeItem("email"),localStorage.removeItem("uid"),localStorage.removeItem("role"),s("/nova-wallet/")}),m.addEventListener("click",()=>{m.getAttribute("aria-expanded")==="true"?x():C()});function C(){m.setAttribute("aria-expanded","true"),d.setAttribute("data-state","opened")}function x(){m.setAttribute("aria-expanded","false"),d.setAttribute("data-state","closing"),d.addEventListener("animationend",()=>{d.setAttribute("data-state","closed")},{once:!0})}return d.appendChild(g),d.appendChild(h),d.appendChild(p),d.appendChild(E),d.appendChild(v),r.appendChild(m),r.appendChild(d),l.appendChild(i),l.appendChild(r),o.appendChild(l),o},A=()=>{const s=document.createElement("footer"),o=document.createElement("div"),l=document.createElement("p");return o.classList.add("footer-container"),l.textContent="Designed and developed by ©Sara Rioseco 2024",o.appendChild(l),s.appendChild(o),s},T=s=>{const o=document.createElement("div"),l=document.createElement("h3"),i=document.createElement("h2");return o.classList.add("balance-wrapper"),l.classList.add("balance-title"),i.classList.add("balance-subtitle"),l.textContent="your balance is:",i.textContent=`USD ${s.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,o.appendChild(l),o.appendChild(i),o},O=s=>{const o=document.createElement("button"),l=document.createElement("i");return o.id=`button-${s.replace(" ","")}`,o.classList.add("button","icon-button",`${s.replace(" ","")}-button`),l.classList.add("fa",`fa-${s}`,"home-icon"),o.appendChild(l),o};function F(){return{arePasswordsEqual:(a,r)=>a===r,isPasswordValid:a=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(a),isEmailValid:a=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a),cap:a=>typeof a=="string"?a.charAt(0).toUpperCase()+a.slice(1):null}}const J=s=>{const o=document.createElement("div"),l=document.createElement("div"),i=document.createElement("h3"),a=document.createElement("h3"),r=document.createElement("p");return o.classList.add("history-item-wrapper"),l.classList.add("history-item-title"),r.classList.add("history-item-subtitle"),i.textContent=`${F().cap(s.type)}`,a.textContent=`${s.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})} `,r.textContent=`${new Date(s.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`,l.appendChild(i),l.appendChild(a),o.appendChild(l),o.appendChild(r),o},{getData:K,getUserById:Y,getTransactions:G,getBalance:Q}=I(),X=await K();function _(s){const o=localStorage.getItem("uid"),l=Y(X,Number(o)),i=G(l),a=document.createElement("div"),r=document.createElement("main"),m=N(s),y=A(),f=document.createElement("section"),d=document.createElement("h2"),g=T(Q(l)),h=O("credit-card"),p=O("exchange"),E=O("history"),v=O("user"),C=document.createElement("section"),x=document.createElement("h3"),e=document.createElement("section");return d.classList.add("home-left-title","home-title"),d.textContent=`Hello, ${l.name}`,a.className="home-wrapper",r.className="home-content-wrapper",f.classList.add("home-left"),$(h).click(t=>{t.preventDefault(),s("/nova-wallet/deposit")}),$(p).click(t=>{t.preventDefault(),s("/nova-wallet/transfer")}),$(E).click(t=>{t.preventDefault(),s("/nova-wallet/transactions")}),$(v).click(t=>{t.preventDefault(),console.log("aquí se abre un modal para ver datos de usuario")}),$(f).append(d,g,h,p,E,v),x.classList.add("home-right-title","home-title"),x.textContent="Recent Activity",e.classList.add("home-history-wrapper"),C.classList.add("home-right"),i.sort((t,c)=>new Date(c.date)-new Date(t.date)).forEach(t=>{$(e).append(J(t))}),$(C).append(x,e),$(r).append(f,C),$(a).append(m,r,y),a}const{getData:ee,getUserById:te,getBalance:ne}=I(),ae=await ee();function se(s){const o=localStorage.getItem("uid"),l=te(ae,Number(o));let i=ne(l);const a=document.createElement("div"),r=T(i),m=document.createElement("div"),y=document.createElement("main"),f=N(s),d=A(),g=document.createElement("h2"),h=S("amount","deposit-amount","number"),p=W("deposit");return $(p).off("click").on("click",E=>{E.preventDefault();const v=T(i+=Number($("#deposit-amount").val()));return $(a).html(v),!1}),g.textContent="Add funds to your account",m.className="deposit-wrapper",y.className="deposit-content-wrapper",a.classList.add("deposit-balance-div"),$(a).append(r),$(y).append(g,a,h,p),$(m).append(f,y,d),m}function oe(s){const o=document.createElement("div"),l=document.createElement("main"),i=N(s),a=A(),r=document.createElement("h2");return r.textContent="Esta es la opción para transferir",o.className="transfer-wrapper",l.className="transfer-content-wrapper",l.appendChild(r),o.appendChild(i),o.appendChild(l),o.appendChild(a),o}const{getData:re,getUserById:ce,getTransactions:le,getBalance:ie}=I(),de=await re();function ue(s){const o=localStorage.getItem("uid"),l=ce(de,Number(o)),i=le(l),a=ie(l),r=document.createElement("div"),m=document.createElement("main"),y=document.createElement("h2"),f=document.createElement("section"),d=document.createElement("h3"),g=document.createElement("span"),h=N(s),p=A();return y.textContent="Transaction History",y.classList.add("transactions-title"),r.className="transactions-wrapper",m.className="transactions-content-wrapper",f.classList.add("transactions-history-wrapper"),d.classList.add("transactions-balance"),d.textContent="Your total balance is: ",g.textContent=`USD${a.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,$(d).append(g),i.reverse().forEach(E=>{$(f).append(J(E))}),$(m).append(y,f,d),$(r).append(h,m,p),r}const U=document.getElementById("root"),k={"/nova-wallet/":j,"/nova-wallet/signup":Z,"/nova-wallet/home":_,"/nova-wallet/deposit":se,"/nova-wallet/transfer":oe,"/nova-wallet/transactions":ue},P=s=>{for(window.history.pushState({},s,window.location.origin+s);U.firstChild;)U.removeChild(U.firstChild);U.appendChild(k[s](P))};window.onpopstate=()=>{for(;U.firstChild;)U.removeChild(U.firstChild);U.appendChild(k[`${window.location.pathname}`](P))};U.appendChild(k[`${window.location.pathname}`](P));
