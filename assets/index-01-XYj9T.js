(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function l(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(a){if(a.ep)return;a.ep=!0;const c=l(a);fetch(a.href,c)}})();const A=t=>{const o=document.createElement("button");return o.id=`button-${t.replace(" ","")}`,o.classList.add=`${t.replace(" ","")}-button`,o.textContent=`${t.charAt(0).toUpperCase()+t.slice(1)}`,o},U=(t,o,l)=>{const s=document.createElement("div"),a=document.createElement("input"),c=document.createElement("label");return s.classList.add("input-wrapper"),a.classList.add("input","input-text"),c.classList.add("label","input-label"),a.type=l||"search",a.id=`${o}`,a.autocomplete="new-password",a.placeholder=" ",a.name=`${t}`,a.required=!0,l==="number"&&(a.step="0.01",a.min="0.01",a.max="10000.01"),c.setAttribute("for",`${o}`),c.textContent=t==="contact"?"Search contact":t==="amount"?"Enter amount":`Enter your ${t}`,s.append(a,c),s},B=t=>{const o=document.createElement("dialog"),l=document.createElement("div"),s=document.createElement("h3"),a=document.createElement("p"),c=document.createElement("button");for(;o.hasChildNodes();)o.removeChild(o.firstChild);return o.classList.add("modal","msg-modal"),l.classList.add("wrapper","dialog-wrapper"),s.classList.add("title"),c.classList.add("button","close-button"),c.textContent="Ok",$(c).click(()=>{t.callback&&t.callback("/nova-wallet/"),o.close()}),$(s).text(t.title),$(a).text(t.content),$(l).append(s,a,c),$(o).append(l),o};function N(){const t="https://json-server-gamma-brown.vercel.app/users",o=async function(){try{return await(await fetch(t,{credentials:"include"})).json()}catch(e){throw new Error(e)}},l=e=>e.users,s=(e,i)=>{if(!e||!i||typeof i!="number")throw new Error("Wrong argument types");const r=e.find(n=>n.id===i);if(!r)throw new Error("Unable to find user");return r},a=(e,i)=>{if(!e||!i||typeof i!="string")throw new Error("Wrong argument types");const r=e.find(n=>n.email===i);if(!r)throw new Error("Unable to find user");return r},c=async function(e,i,r,n,m){if(!e||!i||!r||!n||!m)throw new Error("Missing arguments");if(typeof i!="string"||typeof r!="string"||typeof n!="string"||typeof m!="string")throw new Error("Wrong argument types");const f={id:e.users.length+1,name:i,lastname:r,email:n,password:m,role:"user",balance:0,transactions:[],contacts:[]};e.users.push(f);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),f}catch(x){throw new Error(x)}},u=async function(e,i,r){if(!e||!i||typeof i!="number")throw new Error("Id of type number is required");const n=s(e,i),m={id:i,name:r.name||n.name,lastname:r.lastname||n.lastname,email:n.email,password:r.password||n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:n.contacts},v=e.indexOf(n);e.splice(v,1,m);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),m}catch(f){throw new Error(f)}},E=async(e,i,r)=>{if(!e||!i||!r||typeof i!="string"||typeof r!="string")throw new Error("Wrong argument types");const n=await a(e,i);if(n&&n.password===r)return n;throw new Error("Wrong credentials")},p=e=>e.balance,d=async(e,i,r)=>{if(!e||!i||!r||typeof i!="number"||typeof r.amount!="number")throw new Error("Wrong argument types");const n=s(e,i),m=n.balance+r.amount,v={id:i,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:m,transactions:n.transactions,contacts:n.contacts},f=e.indexOf(n);e.splice(f,1,v);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),v.balance}catch(x){throw new Error(x)}},h=e=>!e||!e.transactions?[]:e.transactions,y=async(e,i,r)=>{if(!e||!i||!r||typeof i!="number"||typeof r!="number")throw new Error("Wrong argument types");const n=s(e,i),m=h(n),v={date:new Date().toLocaleDateString(),amount:r,type:r>0?"deposit":"transfer"};m.push(v);const f={id:i,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:m,contacts:n.contacts},x=e.indexOf(n);e.splice(x,1,f);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),f.transactions[m.length-1]}catch(D){throw new Error(D)}},g=e=>!e||!e.contacts?[]:e.contacts,b=(e,i,r)=>{if(!e||!i||!r||typeof i!="number"||typeof r!="number")throw new Error("Wrong argument types");const n=s(e,i),m=e.indexOf(n),v=e[m].contacts.find(f=>f.id===r);if(v)return v;throw new Error("Unable to find contact")};return{dataUrl:t,getData:o,getUsers:l,getUserById:s,getUserByEmail:a,createUser:c,updateUser:u,userLogin:E,getBalance:p,updateBalance:d,getTransactions:h,addTransaction:y,getContacts:g,getContactById:b,getContactByName:(e,i,r)=>{if(!e||!i||!r||typeof i!="number"||typeof r!="string")throw new Error("Wrong argument types");const n=s(e,i),m=e.indexOf(n),v=e[m].contacts.filter(f=>f.name.toLowerCase().includes(r.toLowerCase())||f.lastname.toLowerCase().includes(r.toLowerCase()));if(v.length>0)return v;throw new Error("Unable to find contact")},addContact:async(e,i,r)=>{if(!e||!i||!r||typeof i!="number")throw new Error("Wrong argument types");const n=s(e,i),m=g(n),v={id:m.length+1,name:r.name,lastname:r.lastname,email:r.email};m.push(v);const f={id:i,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:m},x=e.indexOf(n);e.splice(x,1,f);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),f.contacts[m.length-1]}catch(D){throw new Error(D)}},updateContact:async(e,i,r,n)=>{if(!e||!i||!r||!n||typeof i!="number"||typeof r!="number")throw new Error("Wrong argument types");const m=s(e,i),v=g(m),f=b(e,i,r),x=v.indexOf(f),D={id:r,name:n.name||f.name,lastname:n.lastname||f.lastname,email:n.email||f.email};v.splice(x,1,D);const k={id:i,name:m.name,lastname:m.lastname,email:m.email,password:m.password,role:m.role,balance:m.balance,transactions:m.transactions,contacts:v},z=e.indexOf(m);e.splice(z,1,k);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),k.contacts[x]}catch(R){throw new Error(R)}},deleteContact:async(e,i,r)=>{if(!e||!i||!r||typeof i!="number"||typeof r!="number")throw new Error("Wrong argument types");const n=s(e,i),m=g(n),v=b(e,i,r),f=m.indexOf(v);m.splice(f,1);const x={id:i,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:m},D=e.indexOf(n);e.splice(D,1,x);try{return await(void 0)(t,JSON.stringify(e),{encoding:"utf-8"}),x.contacts}catch(k){throw new Error(k)}}}}const{getData:Y,userLogin:Z}=N();function F(t){const o=document.createElement("div"),l=document.createElement("form"),s=document.createElement("h1"),a=document.createElement("span"),c=U("username","login-username","text"),u=U("Email","login-email"),E=U("Password","login-password","password"),p=A("login"),d=document.createElement("p"),h=document.createElement("span"),y=B({title:"Error:",content:"Invalid credentials"});return o.className="login-wrapper",l.className="login-content-wrapper",s.textContent="Nova",a.textContent="Wallet",c.autocomplete="username",c.hidden=!0,c.classList.add("visually-hidden"),d.classList.add("login-text"),d.textContent=`Don't have an account?
`,h.textContent="Sign up here.",$(p).click(async g=>{g.preventDefault();const b=$("#login-email").val(),L=$("#login-password").val();try{const C=await Y(),w=await Z(C,b,L);localStorage.setItem("uid",w.id),localStorage.setItem("name",w.name),localStorage.setItem("lastname",w.lastname),localStorage.setItem("email",w.email),localStorage.setItem("role",w.role),t("/nova-wallet/home")}catch(C){y.showModal(),console.error(C)}}),$(h).click(()=>{t("/nova-wallet/signup")}),$(s).append(a),$(d).append(h),$(l).append(s,c,u,E,p,d,y),$(o).append(l),o}const{getData:K,createUser:G}=N();function Q(t){const o=document.createElement("div"),l=document.createElement("form"),s=document.createElement("h1"),a=document.createElement("span"),c=U("username","signup-username","text"),u=U("Name","signup-name","text"),E=U("Lastname","signup-lastname","text"),p=U("Email","signup-email"),d=U("Password","signup-password","password"),h=A("sign up"),y=document.createElement("p"),g=document.createElement("span"),b=B({title:"User created",content:"successfully"}),L=B({title:"Error:",content:"Unable to create user",callback:t});return o.className="signup-wrapper",l.className="signup-content-wrapper",s.textContent="Nova",a.textContent="Wallet",c.autocomplete="username",c.hidden=!0,c.classList.add("visually-hidden"),y.classList.add("signup-text"),y.textContent=`Already have an account?
`,g.textContent="Login here.",$(h).click(async C=>{C.preventDefault();const w=$("#signup-name").val(),S=$("#signup-lastname").val(),e=$("#signup-email").val(),i=$("#signup-password").val();console.log("trying to sign up user: ",w,S,e);try{const r=await K(),n=await G(r,w,S,e,i);localStorage.setItem("uid",n.id),localStorage.setItem("name",n.name),localStorage.setItem("lastname",n.lastname),localStorage.setItem("email",n.email),localStorage.setItem("role",n.role),b.showModal(),t("/nova-wallet/home")}catch(r){console.error(r.message),L.showModal(),$("#signup-name").val(""),$("#signup-lastname").val(""),$("#signup-email").val(""),$("#signup-password").val("")}}),$(g).click(()=>{t("/nova-wallet/")}),$(s).append(a),$(y).append(g),$(l).append(s,c,u,E,p,d,h,y,b,L),$(o).append(l),o}const T=t=>{const o=document.createElement("header"),l=document.createElement("div"),s=document.createElement("h1"),a=document.createElement("span"),c=document.createElement("nav"),u=document.createElement("button"),E=document.createElement("span"),p=document.createElement("div"),d=document.createElement("ul"),h=document.createElement("li"),y=document.createElement("li"),g=document.createElement("li"),b=document.createElement("li"),L=document.createElement("li");l.classList.add("header-container"),s.classList.add("logo"),c.classList.add("site-nav"),u.classList.add("menu-toggle"),s.textContent="Nova",a.textContent="Wallet",u.setAttribute("aria-controls","primary-navigation"),u.setAttribute("aria-expanded","false"),E.classList.add("visually-hidden"),p.classList.add("hamburger"),p.setAttribute("aria-hidden","true"),s.appendChild(a),u.appendChild(E),u.appendChild(p),d.classList.add("primary-navigation"),d.id="primary-navigation",d.setAttribute("data-state","closed"),h.textContent="Home",y.textContent="Deposit",g.textContent="Send Money",b.textContent="Transactions",L.textContent="Logout",s.addEventListener("click",()=>t("/nova-wallet/home")),h.addEventListener("click",()=>t("/nova-wallet/home")),y.addEventListener("click",()=>t("/nova-wallet/deposit")),g.addEventListener("click",()=>t("/nova-wallet/transfer")),b.addEventListener("click",()=>t("/nova-wallet/transactions")),L.addEventListener("click",()=>{localStorage.removeItem("name"),localStorage.removeItem("lastname"),localStorage.removeItem("email"),localStorage.removeItem("uid"),localStorage.removeItem("role"),t("/nova-wallet/")}),u.addEventListener("click",()=>{u.getAttribute("aria-expanded")==="true"?w():C()});function C(){u.setAttribute("aria-expanded","true"),d.setAttribute("data-state","opened")}function w(){u.setAttribute("aria-expanded","false"),d.setAttribute("data-state","closing"),d.addEventListener("animationend",()=>d.setAttribute("data-state","closed"),{once:!0})}return $(d).append(h,y,g,b,L),$(c).append(u,d),$(l).append(s,c),$(o).append(l),o},W=()=>{const t=document.createElement("footer"),o=document.createElement("div"),l=document.createElement("p");return o.classList.add("footer-container"),l.textContent="Designed and developed by ©Sara Rioseco 2024",$(o).append(l),$(t).append(o),t},P=t=>{const o=document.createElement("div"),l=document.createElement("h3"),s=document.createElement("h2");return o.classList.add("balance-wrapper"),l.classList.add("balance-title"),s.classList.add("balance-subtitle"),l.textContent="your balance is:",s.textContent=`USD ${t.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,$(o).append(l,s),o},O=t=>{const o=document.createElement("button"),l=document.createElement("i");return o.id=`button-${t.replace(" ","")}`,o.classList.add("button","icon-button",`${t.replace(" ","")}-button`),l.classList.add("fa",`fa-${t}`,"home-icon"),$(o).append(l),o};function X(){return{arePasswordsEqual:(a,c)=>a===c,isPasswordValid:a=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(a),isEmailValid:a=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a),cap:a=>typeof a=="string"?a.charAt(0).toUpperCase()+a.slice(1):null}}const j=t=>{const o=document.createElement("div"),l=document.createElement("div"),s=document.createElement("h3"),a=document.createElement("h3"),c=document.createElement("p");return o.classList.add("history-item-wrapper"),l.classList.add("history-item-title"),c.classList.add("history-item-subtitle"),s.textContent=`${X().cap(t.type)}`,a.textContent=`${t.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})} `,c.textContent=`${new Date(t.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`,$(l).append(s,a),$(o).append(l,c),o},_=t=>{const o=document.createElement("dialog"),l=document.createElement("div"),s=document.createElement("h3"),a=document.createElement("p"),c=document.createElement("button");for(;o.hasChildNodes();)o.removeChild(o.firstChild);return o.classList.add("modal","msg-modal"),l.classList.add("wrapper","dialog-wrapper"),s.classList.add("title"),c.classList.add("button","close-button"),c.textContent="Ok",$(c).click(()=>o.close()),$(s).text(t.title),$(a).text(t.content),$(l).append(s,a,c),$(o).append(l),o},{getData:tt,getUserById:et,getTransactions:nt,getBalance:at}=N(),ot=await tt();function st(t){const o=localStorage.getItem("uid"),l=et(ot,Number(o)),s=nt(l),a=document.createElement("div"),c=document.createElement("main"),u=T(t),E=W(),p=document.createElement("section"),d=document.createElement("h2"),h=P(at(l)),y=O("credit-card"),g=O("exchange"),b=O("history"),L=O("user"),C=document.createElement("section"),w=document.createElement("h3"),S=document.createElement("section");d.classList.add("home-left-title","home-title"),d.textContent=`Hello, ${l.name}`,a.className="home-wrapper",c.className="home-content-wrapper",p.classList.add("home-left"),$(y).click(r=>{r.preventDefault(),t("/nova-wallet/deposit")}),$(g).click(r=>{r.preventDefault(),t("/nova-wallet/transfer")}),$(b).click(r=>{r.preventDefault(),t("/nova-wallet/transactions")});const i=_({title:"User settings",content:"Here you can change your password"});return $(L).click(r=>{r.preventDefault(),i.showModal()}),$(p).append(d,h,y,g,b,L),w.classList.add("home-right-title","home-title"),w.textContent="Recent Activity",S.classList.add("home-history-wrapper"),C.classList.add("home-right"),s.sort((r,n)=>new Date(n.date)-new Date(r.date)).forEach(r=>{$(S).append(j(r))}),$(C).append(w,S),$(c).append(p,C),$(a).append(u,c,i,E),a}const{getData:ct,getUserById:rt,getBalance:lt}=N(),it=await ct();function dt(t){const o=localStorage.getItem("uid"),l=rt(it,Number(o));let s=lt(l);const a=document.createElement("div"),c=P(s),u=document.createElement("div"),E=document.createElement("main"),p=T(t),d=W(),h=document.createElement("h2"),y=U("amount","deposit-amount","number"),g=A("deposit");return $(g).off("click").on("click",b=>{b.preventDefault();const L=P(s+=Number($("#deposit-amount").val()));return $(a).html(L),$("#deposit-amount").val(""),!1}),h.textContent="Add funds to your account",u.className="deposit-wrapper",E.className="deposit-content-wrapper",a.classList.add("deposit-balance-div"),$(a).append(c),$(E).append(h,a,y,g),$(u).append(p,E,d),u}const M=t=>{const o=document.createElement("div"),l=document.createElement("input"),s=document.createElement("label"),a=document.createElement("span"),c=document.createElement("span");return o.classList.add("contact-wrapper"),l.type="radio",l.id=`contact-${t.id}`,l.name="contact",l.value=`${t.name} ${t.lastname}`,l.classList.add("contact-item",`contact-${t.id}`),l.style.display="none",s.classList.add("contact-label"),s.textContent=`${t.name} ${t.lastname}
`,s.setAttribute("for",`contact-${t.id}`),a.textContent=`${t.bank} `,c.textContent=`#${t.account}`,$(s).append(a,c),$(l).append(s),$(o).append(l,s),o},{getData:mt,getUserById:ut,getContacts:H,getContactByName:pt}=N(),V=await mt();function gt(t){const o=localStorage.getItem("uid"),l=ut(V,Number(o));let s=H(l);const a=document.createElement("div"),c=document.createElement("main"),u=document.createElement("h2"),E=U("contact","contact-search","text"),p=document.createElement("section"),d=document.createElement("form"),h=U("amount","transfer-amount","number"),y=A("Send Money"),g=T(t),b=W(),L=B({title:"Error:",content:"Please select a contact"}),C=B({title:"Error:",content:"Please enter a transfer amount"});return s.forEach(w=>{$(d).append(M(w))}),$(E).off("click").on("keyup",w=>(w.preventDefault(),$("#contact-search").val()!==""?(s=pt(V,Number(o),$("#contact-search").val()),$(d).empty(),s.forEach(S=>{$(d).append(M(S))})):(s=H(l),$(d).empty(),s.forEach(S=>{$(d).append(M(S))})),!1)),$(s).on("change",()=>{$(d).empty(),s.forEach(w=>{$(d).append(M(w))})}),u.textContent="Send Money",a.className="transfer-wrapper",c.className="transfer-content-wrapper",d.classList.add("contacts-list"),p.classList.add("contacts-wrapper"),$(y).click(()=>{if($("input[type='radio'][name='contact']:checked").val()===void 0)L.showModal();else if($("#transfer-amount").val()==="")C.showModal();else{const w=B({title:"Transaction completed",content:`You transferred USD${Number($("#transfer-amount").val()).toLocaleString("en-US",{style:"currency",currency:"USD"})} to ${$("input[type='radio'][name='contact']:checked").val()}`});$(c).append(w),w.showModal(),$("#transfer-amount").val(""),$("#contact-search").val(""),$("input[type='radio'][name='contact']:checked").prop("checked",!1)}}),$(p).append(d,h,y),$(c).append(u,E,p),$(a).append(c,g,L,C,b),a}const{getData:wt,getUserById:ft,getTransactions:ht,getBalance:yt}=N(),Et=await wt();function $t(t){const o=localStorage.getItem("uid"),l=ft(Et,Number(o)),s=ht(l),a=yt(l),c=document.createElement("div"),u=document.createElement("main"),E=document.createElement("h2"),p=document.createElement("section"),d=document.createElement("h3"),h=document.createElement("span"),y=T(t),g=W();return E.textContent="Transaction History",E.classList.add("transactions-title"),c.className="transactions-wrapper",u.className="transactions-content-wrapper",p.classList.add("transactions-history-wrapper"),d.classList.add("transactions-balance"),d.textContent="Your total balance is: ",h.textContent=`USD${a.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,$(d).append(h),s.reverse().forEach(b=>{$(p).append(j(b))}),$(u).append(E,p,d),$(c).append(y,u,g),c}const I=document.getElementById("root"),J={"/nova-wallet/":F,"/nova-wallet/signup":Q,"/nova-wallet/home":st,"/nova-wallet/deposit":dt,"/nova-wallet/transfer":gt,"/nova-wallet/transactions":$t},q=t=>{for(window.history.pushState({},t,window.location.origin+t);I.firstChild;)I.removeChild(I.firstChild);I.appendChild(J[t](q))};window.onpopstate=()=>{for(;I.firstChild;)I.removeChild(I.firstChild);I.appendChild(J[`${window.location.pathname}`](q))};I.appendChild(J[`${window.location.pathname}`](q));
