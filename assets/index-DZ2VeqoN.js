(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function l(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=l(n);fetch(n.href,c)}})();const A=e=>{const r=document.createElement("button");return r.id=`button-${e.replace(" ","")}`,r.classList.add=`${e.replace(" ","")}-button`,r.textContent=`${e.charAt(0).toUpperCase()+e.slice(1)}`,r},x=(e,r,l)=>{const s=document.createElement("div"),n=document.createElement("input"),c=document.createElement("label");return s.classList.add("input-wrapper"),n.classList.add("input","input-text"),c.classList.add("label","input-label"),n.type=l||"search",n.id=`${r}`,n.autocomplete="new-password",n.placeholder=" ",n.name=`${e}`,n.required=!0,l==="number"&&(n.step="0.01",n.min="0.01",n.max="10000.01"),c.setAttribute("for",`${r}`),c.textContent=e==="contact"?"Search contact":e==="amount"?"Enter amount":`Enter your ${e}`,s.appendChild(n),s.appendChild(c),s};function B(){const e="https://json-server-gamma-brown.vercel.app/users",r=async function(){try{return await(await fetch(e,{credentials:"include"})).json()}catch(t){throw new Error(t)}},l=t=>t.users,s=(t,o)=>{if(!t||!o||typeof o!="number")throw new Error("Wrong argument types");const i=t.find(a=>a.id===o);if(!i)throw new Error("Unable to find user");return i},n=(t,o)=>{if(!t||!o||typeof o!="string")throw new Error("Wrong argument types");const i=t.find(a=>a.email===o);if(!i)throw new Error("Unable to find user");return i},c=async function(t,o,i,a,m){if(!t||!o||!i||!a||!m)throw new Error("Missing arguments");if(typeof o!="string"||typeof i!="string"||typeof a!="string"||typeof m!="string")throw new Error("Wrong argument types");const f={id:t.users.length+1,name:o,lastname:i,email:a,password:m,role:"user",balance:0,transactions:[],contacts:[]};t.users.push(f);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),f}catch(L){throw new Error(L)}},u=async function(t,o,i){if(!t||!o||typeof o!="number")throw new Error("Id of type number is required");const a=s(t,o),m={id:o,name:i.name||a.name,lastname:i.lastname||a.lastname,email:a.email,password:i.password||a.password,role:a.role,balance:a.balance,transactions:a.transactions,contacts:a.contacts},E=t.indexOf(a);t.splice(E,1,m);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),m}catch(f){throw new Error(f)}},y=async(t,o,i)=>{if(!t||!o||!i||typeof o!="string"||typeof i!="string")throw new Error("Wrong argument types");const a=await n(t,o);if(a&&a.password===i)return a;throw new Error("Wrong credentials")},p=t=>t.balance,d=async(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i.amount!="number")throw new Error("Wrong argument types");const a=s(t,o),m=a.balance+i.amount,E={id:o,name:a.name,lastname:a.lastname,email:a.email,password:a.password,role:a.role,balance:m,transactions:a.transactions,contacts:a.contacts},f=t.indexOf(a);t.splice(f,1,E);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),E.balance}catch(L){throw new Error(L)}},w=t=>!t||!t.transactions?[]:t.transactions,h=async(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const a=s(t,o),m=w(a),E={date:new Date().toLocaleDateString(),amount:i,type:i>0?"deposit":"transfer"};m.push(E);const f={id:o,name:a.name,lastname:a.lastname,email:a.email,password:a.password,role:a.role,balance:a.balance,transactions:m,contacts:a.contacts},L=t.indexOf(a);t.splice(L,1,f);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),f.transactions[m.length-1]}catch(D){throw new Error(D)}},g=t=>!t||!t.contacts?[]:t.contacts,b=(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const a=s(t,o),m=t.indexOf(a),E=t[m].contacts.find(f=>f.id===i);if(E)return E;throw new Error("Unable to find contact")};return{dataUrl:e,getData:r,getUsers:l,getUserById:s,getUserByEmail:n,createUser:c,updateUser:u,userLogin:y,getBalance:p,updateBalance:d,getTransactions:w,addTransaction:h,getContacts:g,getContactById:b,getContactByName:(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="string")throw new Error("Wrong argument types");const a=s(t,o),m=t.indexOf(a),E=t[m].contacts.filter(f=>f.name.toLowerCase().includes(i.toLowerCase())||f.lastname.toLowerCase().includes(i.toLowerCase()));if(E.length>0)return E;throw new Error("Unable to find contact")},addContact:async(t,o,i)=>{if(!t||!o||!i||typeof o!="number")throw new Error("Wrong argument types");const a=s(t,o),m=g(a),E={id:m.length+1,name:i.name,lastname:i.lastname,email:i.email};m.push(E);const f={id:o,name:a.name,lastname:a.lastname,email:a.email,password:a.password,role:a.role,balance:a.balance,transactions:a.transactions,contacts:m},L=t.indexOf(a);t.splice(L,1,f);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),f.contacts[m.length-1]}catch(D){throw new Error(D)}},updateContact:async(t,o,i,a)=>{if(!t||!o||!i||!a||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const m=s(t,o),E=g(m),f=b(t,o,i),L=E.indexOf(f),D={id:i,name:a.name||f.name,lastname:a.lastname||f.lastname,email:a.email||f.email};E.splice(L,1,D);const N={id:o,name:m.name,lastname:m.lastname,email:m.email,password:m.password,role:m.role,balance:m.balance,transactions:m.transactions,contacts:E},V=t.indexOf(m);t.splice(V,1,N);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),N.contacts[L]}catch(j){throw new Error(j)}},deleteContact:async(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const a=s(t,o),m=g(a),E=b(t,o,i),f=m.indexOf(E);m.splice(f,1);const L={id:o,name:a.name,lastname:a.lastname,email:a.email,password:a.password,role:a.role,balance:a.balance,transactions:a.transactions,contacts:m},D=t.indexOf(a);t.splice(D,1,L);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),L.contacts}catch(N){throw new Error(N)}}}}const{getData:z,userLogin:R}=B();function Y(e){const r=document.createElement("div"),l=document.createElement("form"),s=document.createElement("h1"),n=document.createElement("span"),c=x("username","login-username","text"),u=x("Email","login-email"),y=x("Password","login-password","password"),p=A("login"),d=document.createElement("p"),w=document.createElement("span");return r.className="login-wrapper",l.className="login-content-wrapper",s.textContent="Nova",n.textContent="Wallet",c.autocomplete="username",c.hidden=!0,c.classList.add("visually-hidden"),d.classList.add("login-text"),d.textContent=`Don't have an account?
`,w.textContent="Sign up here.",$(p).click(async h=>{h.preventDefault();const g=$("#login-email").val(),b=$("#login-password").val();try{const v=await z(),C=await R(v,g,b);localStorage.setItem("uid",C.id),localStorage.setItem("name",C.name),localStorage.setItem("lastname",C.lastname),localStorage.setItem("email",C.email),localStorage.setItem("role",C.role),e("/nova-wallet/home")}catch(v){alert("Invalid credentials"),console.error(v)}}),$(w).click(()=>{e("/nova-wallet/signup")}),$(s).append(n),$(d).append(w),$(l).append(s,c,u,y,p,d),$(r).append(l),r}const{getData:Z,createUser:F}=B();function K(e){const r=document.createElement("div"),l=document.createElement("form"),s=document.createElement("h1"),n=document.createElement("span"),c=x("username","signup-username","text"),u=x("Name","signup-name","text"),y=x("Lastname","signup-lastname","text"),p=x("Email","signup-email"),d=x("Password","signup-password","password"),w=A("sign up"),h=document.createElement("p"),g=document.createElement("span");return r.className="signup-wrapper",l.className="signup-content-wrapper",s.textContent="Nova",n.textContent="Wallet",c.autocomplete="username",c.hidden=!0,c.classList.add("visually-hidden"),h.classList.add("signup-text"),h.textContent=`Already have an account?
`,g.textContent="Login here.",$(w).click(async b=>{b.preventDefault();const v=$("#signup-name").val(),C=$("#signup-lastname").val(),S=$("#signup-email").val(),I=$("#signup-password").val();console.log("trying to sign up user: ",v,C,S);try{const t=await Z(),o=await F(t,v,C,S,I);localStorage.setItem("uid",o.id),localStorage.setItem("name",o.name),localStorage.setItem("lastname",o.lastname),localStorage.setItem("email",o.email),localStorage.setItem("role",o.role),alert("User created successfully"),e("/nova-wallet/home")}catch(t){alert("Unable to create user"),console.error(t.message)}e("/nova-wallet/home")}),$(g).click(()=>{e("/nova-wallet/")}),$(s).append(n),$(h).append(g),$(l).append(s,c,u,y,p,d,w,h),$(r).append(l),r}const k=e=>{const r=document.createElement("header"),l=document.createElement("div"),s=document.createElement("h1"),n=document.createElement("span"),c=document.createElement("nav"),u=document.createElement("button"),y=document.createElement("span"),p=document.createElement("div"),d=document.createElement("ul"),w=document.createElement("li"),h=document.createElement("li"),g=document.createElement("li"),b=document.createElement("li"),v=document.createElement("li");l.classList.add("header-container"),s.classList.add("logo"),c.classList.add("site-nav"),u.classList.add("menu-toggle"),s.textContent="Nova",n.textContent="Wallet",u.setAttribute("aria-controls","primary-navigation"),u.setAttribute("aria-expanded","false"),y.classList.add("visually-hidden"),p.classList.add("hamburger"),p.setAttribute("aria-hidden","true"),s.appendChild(n),u.appendChild(y),u.appendChild(p),d.classList.add("primary-navigation"),d.id="primary-navigation",d.setAttribute("data-state","closed"),w.textContent="Home",h.textContent="Deposit",g.textContent="Send Money",b.textContent="Transactions",v.textContent="Logout",s.addEventListener("click",()=>e("/nova-wallet/home")),w.addEventListener("click",()=>e("/nova-wallet/home")),h.addEventListener("click",()=>e("/nova-wallet/deposit")),g.addEventListener("click",()=>e("/nova-wallet/transfer")),b.addEventListener("click",()=>e("/nova-wallet/transactions")),v.addEventListener("click",()=>{localStorage.removeItem("name"),localStorage.removeItem("lastname"),localStorage.removeItem("email"),localStorage.removeItem("uid"),localStorage.removeItem("role"),e("/nova-wallet/")}),u.addEventListener("click",()=>{u.getAttribute("aria-expanded")==="true"?S():C()});function C(){u.setAttribute("aria-expanded","true"),d.setAttribute("data-state","opened")}function S(){u.setAttribute("aria-expanded","false"),d.setAttribute("data-state","closing"),d.addEventListener("animationend",()=>{d.setAttribute("data-state","closed")},{once:!0})}return d.appendChild(w),d.appendChild(h),d.appendChild(g),d.appendChild(b),d.appendChild(v),c.appendChild(u),c.appendChild(d),l.appendChild(s),l.appendChild(c),r.appendChild(l),r},T=()=>{const e=document.createElement("footer"),r=document.createElement("div"),l=document.createElement("p");return r.classList.add("footer-container"),l.textContent="Designed and developed by ©Sara Rioseco 2024",r.appendChild(l),e.appendChild(r),e},W=e=>{const r=document.createElement("div"),l=document.createElement("h3"),s=document.createElement("h2");return r.classList.add("balance-wrapper"),l.classList.add("balance-title"),s.classList.add("balance-subtitle"),l.textContent="your balance is:",s.textContent=`USD ${e.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,r.appendChild(l),r.appendChild(s),r},O=e=>{const r=document.createElement("button"),l=document.createElement("i");return r.id=`button-${e.replace(" ","")}`,r.classList.add("button","icon-button",`${e.replace(" ","")}-button`),l.classList.add("fa",`fa-${e}`,"home-icon"),r.appendChild(l),r};function G(){return{arePasswordsEqual:(n,c)=>n===c,isPasswordValid:n=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(n),isEmailValid:n=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(n),cap:n=>typeof n=="string"?n.charAt(0).toUpperCase()+n.slice(1):null}}const H=e=>{const r=document.createElement("div"),l=document.createElement("div"),s=document.createElement("h3"),n=document.createElement("h3"),c=document.createElement("p");return r.classList.add("history-item-wrapper"),l.classList.add("history-item-title"),c.classList.add("history-item-subtitle"),s.textContent=`${G().cap(e.type)}`,n.textContent=`${e.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})} `,c.textContent=`${new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`,l.appendChild(s),l.appendChild(n),r.appendChild(l),r.appendChild(c),r},{getData:Q,getUserById:X,getTransactions:_,getBalance:tt}=B(),et=await Q();function nt(e){const r=localStorage.getItem("uid"),l=X(et,Number(r)),s=_(l),n=document.createElement("div"),c=document.createElement("main"),u=k(e),y=T(),p=document.createElement("section"),d=document.createElement("h2"),w=W(tt(l)),h=O("credit-card"),g=O("exchange"),b=O("history"),v=O("user"),C=document.createElement("section"),S=document.createElement("h3"),I=document.createElement("section");return d.classList.add("home-left-title","home-title"),d.textContent=`Hello, ${l.name}`,n.className="home-wrapper",c.className="home-content-wrapper",p.classList.add("home-left"),$(h).click(t=>{t.preventDefault(),e("/nova-wallet/deposit")}),$(g).click(t=>{t.preventDefault(),e("/nova-wallet/transfer")}),$(b).click(t=>{t.preventDefault(),e("/nova-wallet/transactions")}),$(v).click(t=>{t.preventDefault(),console.log("aquí se abre un modal para ver datos de usuario")}),$(p).append(d,w,h,g,b,v),S.classList.add("home-right-title","home-title"),S.textContent="Recent Activity",I.classList.add("home-history-wrapper"),C.classList.add("home-right"),s.sort((t,o)=>new Date(o.date)-new Date(t.date)).forEach(t=>{$(I).append(H(t))}),$(C).append(S,I),$(c).append(p,C),$(n).append(u,c,y),n}const{getData:at,getUserById:ot,getBalance:st}=B(),rt=await at();function ct(e){const r=localStorage.getItem("uid"),l=ot(rt,Number(r));let s=st(l);const n=document.createElement("div"),c=W(s),u=document.createElement("div"),y=document.createElement("main"),p=k(e),d=T(),w=document.createElement("h2"),h=x("amount","deposit-amount","number"),g=A("deposit");return $(g).off("click").on("click",b=>{b.preventDefault();const v=W(s+=Number($("#deposit-amount").val()));return $(n).html(v),$("#deposit-amount").val(""),!1}),w.textContent="Add funds to your account",u.className="deposit-wrapper",y.className="deposit-content-wrapper",n.classList.add("deposit-balance-div"),$(n).append(c),$(y).append(w,n,h,g),$(u).append(p,y,d),u}const M=e=>{const r=document.createElement("div"),l=document.createElement("input"),s=document.createElement("label"),n=document.createElement("span"),c=document.createElement("span");return r.classList.add("contact-wrapper"),l.type="radio",l.id=`contact-${e.id}`,l.name="contact",l.value=`${e.name} ${e.lastname}`,l.classList.add("contact-item",`contact-${e.id}`),l.style.display="none",s.classList.add("contact-label"),s.textContent=`${e.name} ${e.lastname}
`,s.setAttribute("for",`contact-${e.id}`),n.textContent=`${e.bank} `,c.textContent=`#${e.account}`,s.append(n,c),l.appendChild(s),$(r).append(l,s),r},{getData:lt,getUserById:it,getContacts:dt,getContactByName:mt}=B(),q=await lt();function ut(e){const r=localStorage.getItem("uid"),l=it(q,Number(r));let s=dt(l);const n=document.createElement("div"),c=document.createElement("main"),u=document.createElement("h2"),y=x("contact","contact-search","text"),p=document.createElement("section"),d=document.createElement("form"),w=x("amount","transfer-amount","number"),h=A("Send Money"),g=k(e),b=T();return $(y).on("keyup",()=>{s=mt(q,Number(r),$("#contact-search").val()),console.log("contactos encontrados: ",s)}),s.forEach(v=>{$(d).append(M(v))}),$(s).on("change",()=>{$(d).empty(),s.forEach(v=>{$(d).append(M(v))})}),u.textContent="Send Money",n.className="transfer-wrapper",c.className="transfer-content-wrapper",d.classList.add("contacts-list"),p.classList.add("contacts-wrapper"),$(h).click(()=>{$("#transfer-amount").val()===""?alert("Please enter a transfer amount"):(alert(`You transferred USD${Number($("#transfer-amount").val()).toLocaleString("en-US",{style:"currency",currency:"USD"})} to ${$("input[type='radio'][name='contact']:checked").val()}`),$("#transfer-amount").val(""))}),$(p).append(d,w,h),$(c).append(u,y,p),$(n).append(c,g,b),n}const{getData:pt,getUserById:gt,getTransactions:ft,getBalance:wt}=B(),ht=await pt();function yt(e){const r=localStorage.getItem("uid"),l=gt(ht,Number(r)),s=ft(l),n=wt(l),c=document.createElement("div"),u=document.createElement("main"),y=document.createElement("h2"),p=document.createElement("section"),d=document.createElement("h3"),w=document.createElement("span"),h=k(e),g=T();return y.textContent="Transaction History",y.classList.add("transactions-title"),c.className="transactions-wrapper",u.className="transactions-content-wrapper",p.classList.add("transactions-history-wrapper"),d.classList.add("transactions-balance"),d.textContent="Your total balance is: ",w.textContent=`USD${n.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,$(d).append(w),s.reverse().forEach(b=>{$(p).append(H(b))}),$(u).append(y,p,d),$(c).append(h,u,g),c}const U=document.getElementById("root"),P={"/nova-wallet/":Y,"/nova-wallet/signup":K,"/nova-wallet/home":nt,"/nova-wallet/deposit":ct,"/nova-wallet/transfer":ut,"/nova-wallet/transactions":yt},J=e=>{for(window.history.pushState({},e,window.location.origin+e);U.firstChild;)U.removeChild(U.firstChild);U.appendChild(P[e](J))};window.onpopstate=()=>{for(;U.firstChild;)U.removeChild(U.firstChild);U.appendChild(P[`${window.location.pathname}`](J))};U.appendChild(P[`${window.location.pathname}`](J));
