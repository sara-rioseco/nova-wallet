(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function l(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=l(a);fetch(a.href,r)}})();const A=e=>{const c=document.createElement("button");return c.id=`button-${e.replace(" ","")}`,c.classList.add=`${e.replace(" ","")}-button`,c.textContent=`${e.charAt(0).toUpperCase()+e.slice(1)}`,c},U=(e,c,l)=>{const s=document.createElement("div"),a=document.createElement("input"),r=document.createElement("label");return s.classList.add("input-wrapper"),a.classList.add("input","input-text"),r.classList.add("label","input-label"),a.type=l||"search",a.id=`${c}`,a.autocomplete="new-password",a.placeholder=" ",a.name=`${e}`,a.required=!0,l==="number"&&(a.step="0.01",a.min="0.01",a.max="10000.01"),r.setAttribute("for",`${c}`),r.textContent=e==="contact"?"Search contact":e==="amount"?"Enter amount":`Enter your ${e}`,s.append(a,r),s},I=e=>{const c=document.createElement("dialog"),l=document.createElement("div"),s=document.createElement("h3"),a=document.createElement("p"),r=document.createElement("button");for(;c.hasChildNodes();)c.removeChild(c.firstChild);return c.classList.add("modal","msg-modal"),l.classList.add("wrapper","dialog-wrapper"),s.classList.add("title"),r.classList.add("button","close-button"),r.textContent="Ok",$(r).click(()=>{e.callback&&e.callback("/nova-wallet/"),c.close()}),$(s).text(e.title),$(a).text(e.content),$(l).append(s,a,r),$(c).append(l),c};function N(){const e="https://json-server-gamma-brown.vercel.app/users",c=async function(){try{return await(await fetch(e,{credentials:"include"})).json()}catch(t){throw new Error(t)}},l=t=>t.users,s=(t,o)=>{if(!t||!o||typeof o!="number")throw new Error("Wrong argument types");const i=t.find(n=>n.id===o);if(!i)throw new Error("Unable to find user");return i},a=(t,o)=>{if(!t||!o||typeof o!="string")throw new Error("Wrong argument types");const i=t.find(n=>n.email===o);if(!i)throw new Error("Unable to find user");return i},r=async function(t,o,i,n,m){if(!t||!o||!i||!n||!m)throw new Error("Missing arguments");if(typeof o!="string"||typeof i!="string"||typeof n!="string"||typeof m!="string")throw new Error("Wrong argument types");const g={id:t.users.length+1,name:o,lastname:i,email:n,password:m,role:"user",balance:0,transactions:[],contacts:[]};t.users.push(g);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),g}catch(x){throw new Error(x)}},u=async function(t,o,i){if(!t||!o||typeof o!="number")throw new Error("Id of type number is required");const n=s(t,o),m={id:o,name:i.name||n.name,lastname:i.lastname||n.lastname,email:n.email,password:i.password||n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:n.contacts},v=t.indexOf(n);t.splice(v,1,m);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),m}catch(g){throw new Error(g)}},E=async(t,o,i)=>{if(!t||!o||!i||typeof o!="string"||typeof i!="string")throw new Error("Wrong argument types");const n=await a(t,o);if(n&&n.password===i)return n;throw new Error("Wrong credentials")},p=t=>t.balance,d=async(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i.amount!="number")throw new Error("Wrong argument types");const n=s(t,o),m=n.balance+i.amount,v={id:o,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:m,transactions:n.transactions,contacts:n.contacts},g=t.indexOf(n);t.splice(g,1,v);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),v.balance}catch(x){throw new Error(x)}},w=t=>!t||!t.transactions?[]:t.transactions,h=async(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const n=s(t,o),m=w(n),v={date:new Date().toLocaleDateString(),amount:i,type:i>0?"deposit":"transfer"};m.push(v);const g={id:o,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:m,contacts:n.contacts},x=t.indexOf(n);t.splice(x,1,g);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),g.transactions[m.length-1]}catch(B){throw new Error(B)}},f=t=>!t||!t.contacts?[]:t.contacts,y=(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const n=s(t,o),m=t.indexOf(n),v=t[m].contacts.find(g=>g.id===i);if(v)return v;throw new Error("Unable to find contact")};return{dataUrl:e,getData:c,getUsers:l,getUserById:s,getUserByEmail:a,createUser:r,updateUser:u,userLogin:E,getBalance:p,updateBalance:d,getTransactions:w,addTransaction:h,getContacts:f,getContactById:y,getContactByName:(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="string")throw new Error("Wrong argument types");const n=s(t,o),m=t.indexOf(n),v=t[m].contacts.filter(g=>g.name.toLowerCase().includes(i.toLowerCase())||g.lastname.toLowerCase().includes(i.toLowerCase()));if(v.length>0)return v;throw new Error("Unable to find contact")},addContact:async(t,o,i)=>{if(!t||!o||!i||typeof o!="number")throw new Error("Wrong argument types");const n=s(t,o),m=f(n),v={id:m.length+1,name:i.name,lastname:i.lastname,email:i.email};m.push(v);const g={id:o,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:m},x=t.indexOf(n);t.splice(x,1,g);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),g.contacts[m.length-1]}catch(B){throw new Error(B)}},updateContact:async(t,o,i,n)=>{if(!t||!o||!i||!n||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const m=s(t,o),v=f(m),g=y(t,o,i),x=v.indexOf(g),B={id:i,name:n.name||g.name,lastname:n.lastname||g.lastname,email:n.email||g.email};v.splice(x,1,B);const M={id:o,name:m.name,lastname:m.lastname,email:m.email,password:m.password,role:m.role,balance:m.balance,transactions:m.transactions,contacts:v},z=t.indexOf(m);t.splice(z,1,M);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),M.contacts[x]}catch(F){throw new Error(F)}},deleteContact:async(t,o,i)=>{if(!t||!o||!i||typeof o!="number"||typeof i!="number")throw new Error("Wrong argument types");const n=s(t,o),m=f(n),v=y(t,o,i),g=m.indexOf(v);m.splice(g,1);const x={id:o,name:n.name,lastname:n.lastname,email:n.email,password:n.password,role:n.role,balance:n.balance,transactions:n.transactions,contacts:m},B=t.indexOf(n);t.splice(B,1,x);try{return await(void 0)(e,JSON.stringify(t),{encoding:"utf-8"}),x.contacts}catch(M){throw new Error(M)}}}}const{getData:R,userLogin:Y}=N();function Z(e){const c=document.createElement("div"),l=document.createElement("form"),s=document.createElement("h1"),a=document.createElement("span"),r=U("username","login-username","text"),u=U("Email","login-email"),E=U("Password","login-password","password"),p=A("login"),d=document.createElement("p"),w=document.createElement("span"),h=I({title:"Error",content:"Invalid credentials"});return c.className="login-wrapper",l.className="login-content-wrapper",s.textContent="Nova",a.textContent="Wallet",r.autocomplete="username",r.hidden=!0,r.classList.add("visually-hidden"),d.classList.add("login-text"),d.textContent=`Don't have an account?
`,w.textContent="Sign up here.",$(p).click(async f=>{f.preventDefault();const y=$("#login-email").val(),L=$("#login-password").val();try{const C=await R(),b=await Y(C,y,L);localStorage.setItem("uid",b.id),localStorage.setItem("name",b.name),localStorage.setItem("lastname",b.lastname),localStorage.setItem("email",b.email),localStorage.setItem("role",b.role),e("/nova-wallet/home")}catch(C){h.showModal(),console.error(C)}}),$(w).click(()=>{e("/nova-wallet/signup")}),$(s).append(a),$(d).append(w),$(l).append(s,r,u,E,p,d,h),$(c).append(l),c}const{getData:K,createUser:G}=N();function Q(e){const c=document.createElement("div"),l=document.createElement("form"),s=document.createElement("h1"),a=document.createElement("span"),r=U("username","signup-username","text"),u=U("Name","signup-name","text"),E=U("Lastname","signup-lastname","text"),p=U("Email","signup-email"),d=U("Password","signup-password","password"),w=A("sign up"),h=document.createElement("p"),f=document.createElement("span"),y=I({title:"User created",content:"successfully"}),L=I({title:"Error",content:"Unable to create user",callback:e});return c.className="signup-wrapper",l.className="signup-content-wrapper",s.textContent="Nova",a.textContent="Wallet",r.autocomplete="username",r.hidden=!0,r.classList.add("visually-hidden"),h.classList.add("signup-text"),h.textContent=`Already have an account?
`,f.textContent="Login here.",$(w).click(async C=>{C.preventDefault();const b=$("#signup-name").val(),S=$("#signup-lastname").val(),t=$("#signup-email").val(),o=$("#signup-password").val();console.log("trying to sign up user: ",b,S,t);try{const i=await K(),n=await G(i,b,S,t,o);localStorage.setItem("uid",n.id),localStorage.setItem("name",n.name),localStorage.setItem("lastname",n.lastname),localStorage.setItem("email",n.email),localStorage.setItem("role",n.role),y.showModal(),e("/nova-wallet/home")}catch(i){console.error(i.message),L.showModal(),$("#signup-name").val(""),$("#signup-lastname").val(""),$("#signup-email").val(""),$("#signup-password").val("")}}),$(f).click(()=>{e("/nova-wallet/")}),$(s).append(a),$(h).append(f),$(l).append(s,r,u,E,p,d,w,h,y,L),$(c).append(l),c}const T=e=>{const c=document.createElement("header"),l=document.createElement("div"),s=document.createElement("h1"),a=document.createElement("span"),r=document.createElement("nav"),u=document.createElement("button"),E=document.createElement("span"),p=document.createElement("div"),d=document.createElement("ul"),w=document.createElement("li"),h=document.createElement("li"),f=document.createElement("li"),y=document.createElement("li"),L=document.createElement("li");l.classList.add("header-container"),s.classList.add("logo"),r.classList.add("site-nav"),u.classList.add("menu-toggle"),s.textContent="Nova",a.textContent="Wallet",u.setAttribute("aria-controls","primary-navigation"),u.setAttribute("aria-expanded","false"),E.classList.add("visually-hidden"),p.classList.add("hamburger"),p.setAttribute("aria-hidden","true"),s.appendChild(a),u.appendChild(E),u.appendChild(p),d.classList.add("primary-navigation"),d.id="primary-navigation",d.setAttribute("data-state","closed"),w.textContent="Home",h.textContent="Deposit",f.textContent="Send Money",y.textContent="Transactions",L.textContent="Logout",s.addEventListener("click",()=>e("/nova-wallet/home")),w.addEventListener("click",()=>e("/nova-wallet/home")),h.addEventListener("click",()=>e("/nova-wallet/deposit")),f.addEventListener("click",()=>e("/nova-wallet/transfer")),y.addEventListener("click",()=>e("/nova-wallet/transactions")),L.addEventListener("click",()=>{localStorage.removeItem("name"),localStorage.removeItem("lastname"),localStorage.removeItem("email"),localStorage.removeItem("uid"),localStorage.removeItem("role"),e("/nova-wallet/")}),u.addEventListener("click",()=>{u.getAttribute("aria-expanded")==="true"?b():C()});function C(){u.setAttribute("aria-expanded","true"),d.setAttribute("data-state","opened")}function b(){u.setAttribute("aria-expanded","false"),d.setAttribute("data-state","closing"),d.addEventListener("animationend",()=>d.setAttribute("data-state","closed"),{once:!0})}return $(d).append(w,h,f,y,L),$(r).append(u,d),$(l).append(s,r),$(c).append(l),c},W=()=>{const e=document.createElement("footer"),c=document.createElement("div"),l=document.createElement("p");return c.classList.add("footer-container"),l.textContent="Designed and developed by ©Sara Rioseco 2024",$(c).append(l),$(e).append(c),e},P=e=>{const c=document.createElement("div"),l=document.createElement("h3"),s=document.createElement("h2");return c.classList.add("balance-wrapper"),l.classList.add("balance-title"),s.classList.add("balance-subtitle"),l.textContent="your balance is:",s.textContent=`USD ${e.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,$(c).append(l,s),c},O=e=>{const c=document.createElement("button"),l=document.createElement("i");return c.id=`button-${e.replace(" ","")}`,c.classList.add("button","icon-button",`${e.replace(" ","")}-button`),l.classList.add("fa",`fa-${e}`,"home-icon"),$(c).append(l),c};function X(){return{arePasswordsEqual:(a,r)=>a===r,isPasswordValid:a=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(a),isEmailValid:a=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a),cap:a=>typeof a=="string"?a.charAt(0).toUpperCase()+a.slice(1):null}}const j=e=>{const c=document.createElement("div"),l=document.createElement("div"),s=document.createElement("h3"),a=document.createElement("h3"),r=document.createElement("p");return c.classList.add("history-item-wrapper"),l.classList.add("history-item-title"),r.classList.add("history-item-subtitle"),s.textContent=`${X().cap(e.type)}`,a.textContent=`${e.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})} `,r.textContent=`${new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`,$(l).append(s,a),$(c).append(l,r),c},{getData:_,getUserById:tt,getTransactions:et,getBalance:nt}=N(),at=await _();function ot(e){const c=localStorage.getItem("uid"),l=tt(at,Number(c)),s=et(l),a=document.createElement("div"),r=document.createElement("main"),u=T(e),E=W(),p=document.createElement("section"),d=document.createElement("h2"),w=P(nt(l)),h=O("credit-card"),f=O("exchange"),y=O("history"),L=O("user"),C=document.createElement("section"),b=document.createElement("h3"),S=document.createElement("section");d.classList.add("home-left-title","home-title"),d.textContent=`Hello, ${l.name}`,a.className="home-wrapper",r.className="home-content-wrapper",p.classList.add("home-left"),$(h).click(o=>{o.preventDefault(),e("/nova-wallet/deposit")}),$(f).click(o=>{o.preventDefault(),e("/nova-wallet/transfer")}),$(y).click(o=>{o.preventDefault(),e("/nova-wallet/transactions")});const t=I({title:"User information",content:`Name: ${localStorage.getItem("name")}

    Lastname: ${localStorage.getItem("lastname")}

    Email: ${localStorage.getItem("email")}`});return $(L).click(o=>{o.preventDefault(),t.showModal()}),$(p).append(d,w,h,f,y,L),b.classList.add("home-right-title","home-title"),b.textContent="Recent Activity",S.classList.add("home-history-wrapper"),C.classList.add("home-right"),s.sort((o,i)=>new Date(i.date)-new Date(o.date)).forEach(o=>{$(S).append(j(o))}),$(C).append(b,S),$(r).append(p,C),$(a).append(u,r,t,E),a}const{getData:st,getUserById:ct,getBalance:rt}=N(),lt=await st();function it(e){const c=localStorage.getItem("uid"),l=ct(lt,Number(c));let s=rt(l);const a=document.createElement("div"),r=P(s),u=document.createElement("div"),E=document.createElement("main"),p=T(e),d=W(),w=document.createElement("h2"),h=U("amount","deposit-amount","number"),f=A("deposit"),y=I({title:"Error",content:"Invalid amount"}),L=I({title:"Successful operation",content:"Funds added to you account"});return $(f).off("click").on("click",C=>{if(C.preventDefault(),+$("#deposit-amount").val()>0){const b=P(s+=Number($("#deposit-amount").val()));L.showModal(),$(a).html(b),$("#deposit-amount").val("")}else y.showModal();return!1}),w.textContent="Add funds to your account",u.className="deposit-wrapper",E.className="deposit-content-wrapper",a.classList.add("deposit-balance-div"),$(a).append(r),$(E).append(w,a,h,f),$(u).append(p,E,y,L,d),u}const k=e=>{const c=document.createElement("div"),l=document.createElement("input"),s=document.createElement("label"),a=document.createElement("span"),r=document.createElement("span");return c.classList.add("contact-wrapper"),l.type="radio",l.id=`contact-${e.id}`,l.name="contact",l.value=`${e.name} ${e.lastname}`,l.classList.add("contact-item",`contact-${e.id}`),l.style.display="none",s.classList.add("contact-label"),s.textContent=`${e.name} ${e.lastname}
`,s.setAttribute("for",`contact-${e.id}`),a.textContent=`${e.bank} `,r.textContent=`#${e.account}`,$(s).append(a,r),$(l).append(s),$(c).append(l,s),c},{getData:dt,getUserById:mt,getContacts:H,getContactByName:ut}=N(),V=await dt();function pt(e){const c=localStorage.getItem("uid"),l=mt(V,Number(c));let s=H(l);const a=document.createElement("div"),r=document.createElement("main"),u=document.createElement("h2"),E=U("contact","contact-search","text"),p=document.createElement("section"),d=document.createElement("form"),w=U("amount","transfer-amount","number"),h=A("Send Money"),f=T(e),y=W(),L=I({title:"Error",content:"Please select a contact"}),C=I({title:"Error",content:"Please enter a transfer amount"}),b=I({title:"Error",content:"Invalid transfer amount"});return s.forEach(S=>{$(d).append(k(S))}),$(E).off("click").on("keyup",S=>(S.preventDefault(),$("#contact-search").val()!==""?(s=ut(V,Number(c),$("#contact-search").val()),$(d).empty(),s.forEach(t=>{$(d).append(k(t))})):(s=H(l),$(d).empty(),s.forEach(t=>{$(d).append(k(t))})),!1)),$(s).on("change",()=>{$(d).empty(),s.forEach(S=>{$(d).append(k(S))})}),u.textContent="Send Money",a.className="transfer-wrapper",r.className="transfer-content-wrapper",d.classList.add("contacts-list"),p.classList.add("contacts-wrapper"),$(h).click(()=>{if($("input[type='radio'][name='contact']:checked").val()===void 0)L.showModal();else if($("#transfer-amount").val()==="")C.showModal();else if($("#transfer-amount").val()<=0)b.showModal();else{const S=I({title:"Transaction completed",content:`You transferred USD${Number($("#transfer-amount").val()).toLocaleString("en-US",{style:"currency",currency:"USD"})} to ${$("input[type='radio'][name='contact']:checked").val()}`});$(r).append(S),S.showModal(),$("#transfer-amount").val(""),$("#contact-search").val(""),$("input[type='radio'][name='contact']:checked").prop("checked",!1)}}),$(p).append(d,w,h),$(r).append(u,E,p),$(a).append(r,f,L,C,b,y),a}const{getData:ft,getUserById:gt,getTransactions:wt,getBalance:ht}=N(),yt=await ft();function Et(e){const c=localStorage.getItem("uid"),l=gt(yt,Number(c)),s=wt(l),a=ht(l),r=document.createElement("div"),u=document.createElement("main"),E=document.createElement("h2"),p=document.createElement("section"),d=document.createElement("h3"),w=document.createElement("span"),h=T(e),f=W();return E.textContent="Transaction History",E.classList.add("transactions-title"),r.className="transactions-wrapper",u.className="transactions-content-wrapper",p.classList.add("transactions-history-wrapper"),d.classList.add("transactions-balance"),d.textContent="Your total balance is: ",w.textContent=`USD${a.toLocaleString("en-US",{style:"currency",currency:"USD"})}`,$(d).append(w),s.reverse().forEach(y=>{$(p).append(j(y))}),$(u).append(E,p,d),$(r).append(h,u,f),r}const D=document.getElementById("root"),J={"/nova-wallet/":Z,"/nova-wallet/signup":Q,"/nova-wallet/home":ot,"/nova-wallet/deposit":it,"/nova-wallet/transfer":pt,"/nova-wallet/transactions":Et},q=e=>{for(window.history.pushState({},e,window.location.origin+e);D.firstChild;)D.removeChild(D.firstChild);D.appendChild(J[e](q))};window.onpopstate=()=>{for(;D.firstChild;)D.removeChild(D.firstChild);D.appendChild(J[`${window.location.pathname}`](q))};D.appendChild(J[`${window.location.pathname}`](q));
